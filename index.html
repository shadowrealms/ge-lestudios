<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GE & LE Studios — The Forged Saga</title>
  <meta name="description" content="The Forged Saga by GE & LE Studios — Book 1: Book of the Forged. Book 2: Dragon of the Forged. Cinematic fantasy forged in faith and dragonfire." />
  <meta name="robots" content="index,follow,max-image-preview:large" />
  <meta name="theme-color" content="#0a0a0b" />
  <link rel="canonical" href="https://shadowrealms.github.io/" />
  <link rel="icon" type="image/jpeg" href="gl-logo.jpg" />
  <link rel="apple-touch-icon" href="gl-logo.jpg" />
  <link rel="manifest" href="/manifest.webmanifest" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="GE & LE Studios" />
  <meta property="og:title" content="The Forged Saga — GE & LE Studios" />
  <meta property="og:description" content="A mythic, cinematic fantasy where dragons rise, vows outlast death, and love becomes a weapon against the dark." />
  <meta property="og:image" content="https://raw.githubusercontent.com/shadowrealms/ge-lestudios/main/Screenshot_20250816-031135_Gallery.jpg" />
  <meta name="twitter:card" content="summary_large_image" />
  <link rel="preconnect" href="https://www.youtube.com">
  <link rel="preconnect" href="https://i.ytimg.com">
  <link rel="preload" as="image" href="https://raw.githubusercontent.com/shadowrealms/ge-lestudios/main/Screenshot_20250816-031135_Gallery.jpg">
  <link rel="preload" as="audio" href="forged-theme.mp3">
  <style>
    :root{
      --bg:#0a0a0b; --panel:#121214; --text:#f3f3f3; --muted:#b7b7b7; --ring:#2a2a2f;
      --gold:#caa35a; --gold-2:#e6c27a; --accent:#d39b42;
      --banner:#15120d; --banner-border:#46361b; --overlay:rgba(0,0,0,.75);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html{scroll-behavior:smooth}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 15% -10%, rgba(202,163,90,.08), transparent 60%),
        radial-gradient(1000px 500px at 110% -20%, rgba(202,163,90,.06), transparent 60%),
        var(--bg);
      line-height:1.65;
      overflow-x:hidden; /* stop sideways move */
    }
    img{max-width:100%; display:block}
    a{color:var(--gold-2); text-decoration:none}
    a:hover{opacity:.92}
    .wrap{width:min(1100px, 92vw); margin:0 auto}

    .fade-in{opacity:0; transform:translateY(6px); animation:fade 700ms ease forwards}
    .fade-in.delay{animation-delay:.18s}
    @keyframes fade{to{opacity:1; transform:none}}

    .banner{
      position:sticky; top:0; z-index:50;
      background: radial-gradient(800px 180px at 10% 0, rgba(226,199,120,.18), transparent 60%), var(--banner);
      border-bottom:1px solid var(--banner-border); color:#f7e7b0;
    }
    .banner-inner{width:min(1100px,92vw); margin:0 auto; padding:10px 0; display:flex; align-items:center; gap:12px}
    .pill{display:inline-block; font-size:.78rem; padding:4px 10px; border:1px solid var(--gold); border-radius:999px; color:var(--gold)}
    .banner .spacer{flex:1}
    .banner button{background:transparent; color:#f7e7b0; border:1px solid var(--banner-border); border-radius:10px; padding:6px 10px; cursor:pointer}
    .banner button:hover{border-color:var(--gold-2); color:var(--gold-2)}

    header{
      position:sticky; top:0; z-index:20;
      background:linear-gradient(180deg, rgba(10,10,11,.88), rgba(10,10,11,.55));
      backdrop-filter:saturate(140%) blur(6px);
      border-bottom:1px solid rgba(226,199,120,.12);
    }
    nav{display:flex; align-items:center; gap:14px; padding:10px 0}
    .brand{display:flex; align-items:center; gap:12px; font-weight:800; letter-spacing:.06em}
    .brand img{width:40px; height:40px; border-radius:50%; box-shadow:0 0 14px rgba(202,163,90,.35)}
    .links{margin-left:auto; display:flex; gap:18px; flex-wrap:wrap}
    .links a{padding:8px 10px; opacity:.85}
    .links a:hover{color:var(--gold-2); opacity:1}

    /* music */
    .audio-controls{display:flex; align-items:center; gap:12px; margin-left:16px}
    .mute-btn{
      display:inline-flex; align-items:center; gap:10px; padding:8px 12px; border-radius:10px;
      border:1px solid var(--ring); background:#1a1a1e; color:var(--text); font-weight:700; cursor:pointer;
    }
    .eq{display:inline-grid; grid-template-columns:repeat(4,3px); gap:3px; height:14px}
    .eq span{width:3px; height:100%; background:linear-gradient(#e6c27a,#caa35a); opacity:.85; transform-origin:bottom}
    [aria-pressed="false"] .eq span{animation:none; opacity:.35}
    [aria-pressed="true"] .eq span:nth-child(1){animation:bar 600ms ease-in-out infinite}
    [aria-pressed="true"] .eq span:nth-child(2){animation:bar 540ms ease-in-out infinite}
    [aria-pressed="true"] .eq span:nth-child(3){animation:bar 720ms ease-in-out infinite}
    [aria-pressed="true"] .eq span:nth-child(4){animation:bar 660ms ease-in-out infinite}
    @keyframes bar{0%,100%{transform:scaleY(.25)}50%{transform:scaleY(1)}}

    .hero{padding:80px 0 56px; text-align:center}
    .hero-logo{width:min(820px,95vw); aspect-ratio:16/9; object-fit:cover; border-radius:16px; display:block; margin:0 auto 18px; box-shadow:0 12px 40px rgba(0,0,0,.55), 0 0 28px rgba(202,163,90,.18)}
    .tag{color:var(--gold-2); font-weight:800; letter-spacing:.18em; text-transform:uppercase}
    h1{font-size:clamp(2.1rem,5vw,3.6rem); margin:.35em 0 .1em}
    .subtitle{color:var(--muted); max-width:820px; margin:0 auto}

    section{padding:60px 0}
    h2{font-size:clamp(1.6rem,3.3vw,2.2rem); margin:0 0 8px}
    .grid{display:grid; gap:22px; grid-template-columns:repeat(auto-fit, minmax(260px,1fr)); margin-top:12px}
    .card{background:var(--panel); border:1px solid rgba(226,199,120,.08); border-radius:16px; overflow:hidden; box-shadow:0 8px 28px rgba(0,0,0,.35)}
    .cover{aspect-ratio:3/4; background:#0f0f12; border-bottom:1px solid rgba(226,199,120,.08)}
    .cover img{width:100%; height:100%; object-fit:cover}
    .body{padding:18px; display:grid; gap:10px}
    .badge{font-size:.74rem; letter-spacing:.18em; text-transform:uppercase; color:var(--gold-2)}
    .cta{display:flex; flex-wrap:wrap; gap:10px; margin-top:4px}
    .btn{display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:10px; border:1px solid var(--ring); background:#1a1a1e; color:var(--text); font-weight:700; box-shadow:0 6px 20px rgba(0,0,0,.25); cursor:pointer}
    .btn.secondary{background:transparent}
    .band{margin-top:22px; padding:22px; border-radius:14px; background:rgba(255,255,255,.02); border:1px solid rgba(226,199,120,.08)}
    blockquote{margin:0; color:#e6e6e6}
    blockquote + blockquote{margin-top:10px}

    #trailer{background:#000; box-shadow: inset 0 0 40px rgba(202,163,90,.22)}
    .trailers{display:grid; gap:22px; grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}
    .frame{background:#080808; border:1px solid rgba(202,163,90,.35); border-radius:14px; padding:14px; box-shadow:0 0 25px rgba(202,163,90,.18)}
    .frame h3{margin:4px 0 12px; color:var(--gold)}
    .yt{position:relative; width:100%; padding-top:56.25%; border-radius:10px; overflow:hidden; border:4px solid var(--gold); box-shadow:0 0 22px rgba(202,163,90,.35); background:#000}
    .yt iframe{position:absolute; inset:0; width:100%; height:100%; border:0}

    /* chat bubble (secretary) */
    .sec-fab{
      position:fixed; right:18px; bottom:18px; width:56px; height:56px; border-radius:50%;
      background:#111; color:#fff; display:grid; place-items:center; border:1px solid rgba(226,199,120,.35);
      box-shadow:0 8px 28px rgba(0,0,0,.5); cursor:pointer; z-index:1001;
    }
    .sec-panel{
      position:fixed; right:18px; bottom:86px; width:min(360px, 92vw);
      background:#0f0f11; border:1px solid rgba(226,199,120,.2); border-radius:16px; padding:14px;
      box-shadow:0 30px 70px rgba(0,0,0,.6); display:none; z-index:1001;
    }
    .sec-panel.open{display:block}
    .chatlog{max-height:240px; overflow:auto; display:grid; gap:10px; margin:10px 0}
    .bubble{background:#101012; border:1px solid #2a2a2f; border-radius:14px; padding:10px}
    .bubble.me{margin-left:auto; background:#131318; border-color:#2f2f36}
    .composer{display:flex; gap:8px}
    .composer input{flex:1; min-width:0; padding:10px 12px; border-radius:12px; border:1px solid #2a2a2f; background:#121216; color:var(--text)}
    .composer button{padding:10px 12px; border-radius:12px; border:1px solid #2a2a2f; background:#1a1a1e; color:var(--text); font-weight:700}

    /* reader modal */
    .overlay{position:fixed; inset:0; background:var(--overlay); display:none; z-index:1000; padding:20px}
    .overlay.open{display:block}
    .reader{width:min(920px, 96vw); max-height:88vh; margin:40px auto; background:#0f0f11; border:1px solid rgba(226,199,120,.2); border-radius:16px; box-shadow:0 30px 80px rgba(0,0,0,.6); overflow:auto; padding:22px}
    .reader h3{margin:0 0 6px; color:var(--gold-2)}
    .reader .meta{color:var(--muted); margin-bottom:12px}
    .reader .controls{display:flex; gap:10px; margin-bottom:10px}
    .reader .controls .btn{padding:8px 12px}
    .reader article{white-space:pre-wrap; word-wrap:break-word; margin:0; font-family:ui-serif, Georgia, "Times New Roman", serif; line-height:1.75; font-size:1.02rem; color:#f0f0f0}
  </style>
</head>
<body>

  <!-- Hidden background audio + status -->
  <div id="audioStatus" aria-live="polite" style="position:absolute;left:-9999px"></div>
  <audio id="bgm" src="forged-theme.mp3" preload="none" loop></audio>

  <div class="banner" role="region" aria-label="Site status banner">
    <div class="banner-inner">
      <span class="pill">COMING&nbsp;SOON</span>
      <strong style="margin-left:6px">The Forged Saga — Official Website</strong>
      <span class="spacer"></span>
      <a class="btn secondary" href="#trailer" style="padding:6px 10px">Watch Teasers</a>
      <button type="button" aria-label="Hide announcement" onclick="this.closest('.banner').style.display='none'">Close</button>
    </div>
  </div>

  <header>
    <div class="wrap">
      <nav aria-label="Primary">
        <div class="brand">
          <img src="gl-logo.jpg" alt="GE & LE Studios logo" />
          <span>GE &amp; LE STUDIOS</span>
        </div>

        <!-- MUSIC CONTROLS -->
        <div class="audio-controls" role="group" aria-label="Background music controls">
          <button id="muteBtn" class="mute-btn" type="button" aria-pressed="false" aria-label="Toggle background music (M)">
            <div class="eq" aria-hidden="true"><span></span><span></span><span></span><span></span></div>
            <span id="muteLabel">Play Theme</span>
          </button>
          <label for="vol" class="now-playing" style="position:absolute;left:-9999px">Volume</label>
          <input id="vol" type="range" min="0" max="100" value="70" step="1" aria-label="Background music volume" style="width:110px" />
          <span class="now-playing" id="nowPlaying" aria-live="polite"></span>
        </div>

        <div class="links">
          <a href="#books">Books</a>
          <a href="#posters">Posters</a>
          <a href="#soundtrack">Soundtrack</a>
          <a href="#trailer">Trailer</a>
          <a href="#praise">Praise</a>
          <a href="#verses">Verses</a>
          <a href="#press">Press Kit</a>
          <a href="#about">About</a>
          <a href="#contact">Contact</a>
        </div>
      </nav>
    </div>
  </header>

  <main id="content">
    <!-- HERO -->
    <section class="hero" id="home">
      <div class="wrap">
        <img class="hero-logo fade-in" src="https://raw.githubusercontent.com/shadowrealms/ge-lestudios/main/Screenshot_20250816-031135_Gallery.jpg" alt="The Forged Saga — key art: silhouette before a towering dragon of flame" />
        <div class="tag fade-in delay">FORGED IN FAITH • THE FORGED SAGA</div>
        <h1 class="fade-in delay">The Forged Saga</h1>
        <p class="subtitle fade-in delay">A mythic, cinematic fantasy where dragons rise, vows outlast death, and love becomes a weapon against the dark.</p>
      </div>
    </section>

    <!-- BOOKS -->
    <section id="books" aria-labelledby="books-title">
      <div class="wrap">
        <h2 id="books-title">Books</h2>
        <p class="subtitle">Two pillars of one destiny.</p>

        <div class="grid">
          <!-- Book One -->
          <article class="card fade-in" aria-labelledby="b1-title">
            <div class="cover">
              <img loading="lazy" decoding="async" src="https://raw.githubusercontent.com/shadowrealms/ge-lestudios/main/Screenshot_20250816-031135_Gallery.jpg" alt="Key art — Book of the Forged" />
            </div>
            <div class="body">
              <div class="badge">Book One</div>
              <h3 id="b1-title"><em>Book of the Forged</em></h3>
              <p>Stephen steps beyond the veil where fate is carved in flame and shadow. Forged by trials of heart and soul, he must claim his place before darkness swallows the realms.</p>
              <div class="cta">
                <a class="btn" href="#trailer">Watch Teaser</a>
                <button class="btn secondary" data-read="book1.html" data-title="Book 1 — Book of the Forged" data-meta="Full Chapter (from book1.html)">Read Full Chapter</button>
              </div>
            </div>
          </article>

          <!-- Book Two -->
          <article class="card fade-in delay" aria-labelledby="b2-title">
            <div class="cover">
              <img loading="lazy" decoding="async" src="https://raw.githubusercontent.com/shadowrealms/ge-lestudios/main/Screenshot_20250815-235522_Chrome.jpg" alt="Key art — Dragon of the Forged" />
            </div>
            <div class="body">
              <div class="badge">Book Two</div>
              <h3 id="b2-title"><em>Dragon of the Forged</em></h3>
              <p>In the heart of battle, mortal and dragon souls unite. Prophecy burns like iron, memory bites like frost, and love learns to wield wings.</p>
              <div class="cta">
                <a class="btn" href="#trailer">Watch Teaser</a>
                <button class="btn secondary" data-read="book2.html" data-title="Book 2 — Dragon of the Forged" data-meta="Chapter 30 (loaded from book2.html)">Read Chapter 30</button>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- POSTERS -->
    <section id="posters" aria-labelledby="posters-title">
      <div class="wrap">
        <h2 id="posters-title">Posters</h2>
        <div class="grid">
          <article class="card fade-in">
            <div class="cover">
              <img loading="lazy" decoding="async" src="https://raw.githubusercontent.com/shadowrealms/ge-lestudios/main/Screenshot_20250816-031135_Gallery.jpg" alt="Poster — Book of the Forged" />
            </div>
            <div class="body"><div class="badge">Key Art</div><strong>Book of the Forged</strong></div>
          </article>
          <article class="card fade-in delay">
            <div class="cover">
              <img loading="lazy" decoding="async" src="https://raw.githubusercontent.com/shadowrealms/ge-lestudios/main/Screenshot_20250815-235522_Chrome.jpg" alt="Poster — Dragon of the Forged" />
            </div>
            <div class="body"><div class="badge">Key Art</div><strong>Dragon of the Forged</strong></div>
          </article>
        </div>
      </div>
    </section>

    <!-- SOUNDTRACK -->
    <section id="soundtrack" aria-labelledby="soundtrack-title">
      <div class="wrap">
        <h2 id="soundtrack-title">Soundtrack</h2>
        <p class="subtitle">Music by Darrin Williams. Full OST coming soon.</p>
        <div class="band">
          <strong>Theme: The Forged Saga</strong>
          <audio controls preload="none" style="width:100%" aria-label="Play The Forged Saga theme">
            <source src="forged-theme.mp3" type="audio/mpeg" />
          </audio>
          <p style="margin:.6rem 0 0">
            Or <a class="btn secondary" href="forged-theme.mp3" download>download MP3</a>
          </p>
        </div>
      </div>
    </section>

    <!-- TRAILERS -->
    <section id="trailer" aria-labelledby="trailer-title">
      <div class="wrap">
        <h2 id="trailer-title" style="color:var(--gold); text-shadow:0 0 10px rgba(202,163,90,.7)">Official Cinematic Trailers</h2>
        <div class="trailers">
          <div class="frame">
            <h3>Teaser A</h3>
            <div class="yt"><iframe src="https://www.youtube.com/embed/a0Aun_uEmL0" title="The Forged Saga — Teaser A" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" loading="lazy" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></div>
          </div>
          <div class="frame">
            <h3><span class="badge" style="background:rgba(226,199,120,.12); padding:4px 8px; border-radius:8px; margin-right:8px">New</span>Teaser B</h3>
            <div class="yt"><iframe src="https://www.youtube.com/embed/RMny5gzN4A4" title="The Forged Saga — Teaser B (YouTube Short)" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" loading="lazy" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></div>
          </div>
        </div>
      </div>
    </section>

    <!-- PRAISE -->
    <section id="praise" aria-labelledby="praise-title">
      <div class="wrap">
        <h2 id="praise-title">Critical Praise</h2>
        <p class="subtitle">Early coverage from festival directors, reviewers, producers, and editors.</p>
        <div class="band">
          <blockquote>“Trauma reforged into myth. The relic, the bowing monarchs, the close—‘The war had only just begun.’ Chills. 10/10.” — <em>The Quill & Sword</em> on Book 2, Ch. 30</blockquote>
          <blockquote>“A coherent myth-architecture: dragon sigils, sacred verses, covenant blades.” — Dr. Haruto Sato</blockquote>
        </div>
      </div>
    </section>

    <!-- VERSES -->
    <section id="verses" aria-labelledby="verses-title">
      <div class="wrap">
        <div class="band fade-in">
          <h2 id="verses-title" style="margin:0 0 6px;">Verses</h2>
          <blockquote>“The mountain did not split because of time or storm — it split because war demanded to be born.”</blockquote>
          <blockquote>“Beneath the weight of shadow, the Forged do not bow — they burn.”</blockquote>
          <blockquote>“God’s flame does not flicker in the wind; it roars against the darkness.”</blockquote>
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="contact" aria-labelledby="contact-title">
      <div class="wrap">
        <div class="band fade-in">
          <h2 id="contact-title" style="margin-top:0;">Contact & Requests</h2>
          <p>For rights inquiries, interviews, or materials, send us a note. We’ll get back swiftly.</p>
          <form action="https://formspree.io/f/YOUR_ID" method="POST">
            <div style="display:flex; gap:12px; flex-wrap:wrap">
              <p style="flex:1"><label> Name<br><input type="text" name="name" required></label></p>
              <p style="flex:1"><label> Email<br><input type="email" name="email" required></label></p>
            </div>
            <p><label> Organization (optional)<br><input type="text" name="org"></label></p>
            <p><label> Message<br><textarea name="message" required></textarea></label></p>
            <p class="cta">
              <button class="btn" type="submit">Send Message</button>
              <span class="subtitle" style="align-self:center">Or email: <a href="mailto:gumworld1976@yahoo.com.au">gumworld1976@yahoo.com.au</a></span>
            </p>
            <input type="hidden" name="_subject" value="Forged Saga — Inquiry" />
            <input type="hidden" name="_captcha" value="false" />
          </form>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="wrap" style="text-align:center; padding-top:22px">
      <img src="gl-logo.jpg" alt="GE & LE Studios" style="width:68px; height:68px; border-radius:50%; box-shadow:0 0 18px rgba(202,163,90,.3)" loading="lazy" decoding="async" />
      <p style="margin:10px 0 6px;">© 2025 GE &amp; LE Studios</p>
      <small>Forged in Faith • The Forged Saga</small>
    </div>
  </footer>

  <!-- READER MODAL (loads full files) -->
  <div id="reader" class="overlay" role="dialog" aria-modal="true" aria-labelledby="reader-title">
    <div class="reader">
      <div class="controls">
        <button class="btn" data-close>Close</button>
        <a class="btn secondary" href="#contact">Request Full Manuscript</a>
      </div>
      <h3 id="reader-title"></h3>
      <div class="meta" id="reader-meta"></div>
      <article id="reader-body">Loading…</article>
      <div class="controls" style="margin-top:12px">
        <a class="btn" href="#contact">Request Rights/Press</a>
        <button class="btn secondary" data-close>Close</button>
      </div>
    </div>
  </div>

  <!-- Secretary Chat (no game) -->
  <button class="sec-fab" id="secFab" aria-label="Open Forged Support">💬</button>
  <div class="sec-panel" id="secPanel" role="dialog" aria-label="Forged Support Chat">
    <strong>Forged Support</strong>
    <div id="chatLog" class="chatlog" aria-live="polite"></div>
    <div class="composer">
      <input id="chatInput" placeholder="Type your message..." />
      <button id="chatSend" class="btn" type="button">Send</button>
    </div>
    <p class="subtitle" style="margin-top:8px">This is a demo inbox. For direct replies, email <a href="mailto:gumworld1976@yahoo.com.au">gumworld1976@yahoo.com.au</a>.</p>
  </div>

  <noscript><style>.yt{border:none}</style></noscript>

  <!-- MUSIC + READER + SECRETARY LOGIC -->
  <script>
  (function(){
    /* ===== MUSIC ===== */
    const audio = document.getElementById('bgm');
    const btn   = document.getElementById('muteBtn');
    const label = document.getElementById('muteLabel');
    const nowPlaying = document.getElementById('nowPlaying');
    const vol   = document.getElementById('vol');
    const trailerSection = document.getElementById('trailer');
    const statusEl = document.getElementById('audioStatus');
    const say = (msg)=>{ if(statusEl) statusEl.textContent = msg; };
    if (audio && btn && vol){
      let ctx, source, gain, ctxReady=false;
      function ensureCtx(){
        if (ctxReady) return;
        ctx = new (window.AudioContext || window.webkitAudioContext)();
        source = ctx.createMediaElementSource(audio);
        gain = ctx.createGain();
        source.connect(gain).connect(ctx.destination);
        ctxReady = true;
      }
      function setUI(p){ btn.setAttribute('aria-pressed', p ? 'true' : 'false'); label.textContent = p ? 'Mute Theme' : 'Play Theme'; nowPlaying.textContent = p ? 'Now playing: The Forged Saga — Theme' : ''; }
      function applyVolume(v){ const linear = Math.pow(Math.min(100, Math.max(0, v))/100, 1.5); if (gain) gain.gain.value = linear; audio.volume = 1; }
      function fadeTo(target, ms=300){
        if (!ctxReady) { audio.muted = (target === 0); return; }
        const now = ctx.currentTime; const g = gain.gain;
        try{ g.setValueAtTime(g.value ?? g.defaultValue ?? 0, now); g.linearRampToValueAtTime(target, now + ms/1000); }catch{}
      }
      async function playAudio(){
        try{
          ensureCtx();
          if (ctx.state === 'suspended') await ctx.resume();
          applyVolume(Number(vol.value));
          if (audio.paused) await audio.play();
          localStorage.setItem('bgmEnabled','true'); setUI(true);
          fadeTo(Math.pow((Number(vol.value)||70)/100, 1.5), 300);
          say('Theme playing');
        }catch{ setUI(false); say('Tap Play Theme to start.'); }
      }
      function pauseAudio(){ if (ctxReady) fadeTo(0, 200); audio.pause(); localStorage.setItem('bgmEnabled','false'); setUI(false); say('Theme paused'); }
      let wantPlay = localStorage.getItem('bgmEnabled') === 'true';
      vol.value = String(Math.min(100, Math.max(0, Number(localStorage.getItem('bgmVol') || '70'))));
      btn.addEventListener('click', ()=> audio.paused ? playAudio() : pauseAudio());
      window.addEventListener('keydown', (e)=>{ if (e.key.toLowerCase() === 'm') btn.click(); });
      vol.addEventListener('input', ()=>{ const v = Number(vol.value); localStorage.setItem('bgmVol', String(v)); if (ctxReady) applyVolume(v); });
      const firstGesture = () => { if (wantPlay) playAudio(); window.removeEventListener('pointerdown', firstGesture); };
      window.addEventListener('pointerdown', firstGesture, {once:true});
      let wasPlayingBeforeTrailer = false;
      function maybePauseForTrailer(){ if (audio && !audio.paused) { wasPlayingBeforeTrailer = true; pauseAudio(); } }
      function maybeResumeAfterTrailer(){ if (wasPlayingBeforeTrailer) { wasPlayingBeforeTrailer = false; if (localStorage.getItem('bgmEnabled')==='true') playAudio(); } }
      if (trailerSection){
        trailerSection.addEventListener('pointerdown', maybePauseForTrailer);
        trailerSection.addEventListener('focusin',   maybePauseForTrailer);
        document.addEventListener('pointerdown', (e)=>{ if (!trailerSection.contains(e.target)) maybeResumeAfterTrailer(); });
      }
      setUI(false);
    }

    /* ===== READER: LOAD FULL FILES ===== */
    const reader = document.getElementById('reader');
    const rTitle = document.getElementById('reader-title');
    const rMeta  = document.getElementById('reader-meta');
    const rBody  = document.getElementById('reader-body');
    function openReader(title, meta){ reader.classList.add('open'); document.body.style.overflow='hidden'; rTitle.textContent=title; rMeta.textContent=meta; rBody.textContent='Loading…'; }
    function closeReader(){ reader.classList.remove('open'); document.body.style.overflow=''; }
    document.querySelectorAll('[data-close]').forEach(b=> b.addEventListener('click', closeReader));
    reader.addEventListener('click', (e)=>{ if (e.target === reader) closeReader(); });
    window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeReader(); });

    // Buttons that fetch chapter files
    document.querySelectorAll('[data-read]').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const url = btn.getAttribute('data-read');
        const ttl = btn.getAttribute('data-title') || 'Reader';
        const meta = btn.getAttribute('data-meta') || '';
        openReader(ttl, meta);
        try{
          const res = await fetch(url, {cache:'no-store'});
          if(!res.ok) throw new Error(res.status);
          const html = await res.text();
          // Strip outer HTML if present, keep main text
          const tmp = document.createElement('div'); tmp.innerHTML = html;
          let main = tmp.querySelector('main, article, pre, body') || tmp;
          rBody.textContent = main.textContent.trim() || html; // show plain text for reliable formatting
        }catch(e){
          rBody.textContent = 'Could not load chapter. Make sure "'+url+'" is in the same folder.';
        }
      });
    });

    /* ===== SECRETARY CHAT (demo) ===== */
    const fab = document.getElementById('secFab');
    const panel = document.getElementById('secPanel');
    const logEl = document.getElementById('chatLog');
    const inputEl = document.getElementById('chatInput');
    const sendBtn = document.getElementById('chatSend');
    const KEY='forged-support';
    function render(){
      logEl.innerHTML='';
      const messages = JSON.parse(localStorage.getItem(KEY)||'[]');
      for (const m of messages){
        const b = document.createElement('div');
        b.className='bubble'+(m.me?' me':'');
        b.innerHTML = `<div style="color:#9aa; font-size:.85rem">${m.time}</div><div>${m.text}</div>`;
        logEl.appendChild(b);
      }
      logEl.scrollTop = logEl.scrollHeight;
    }
    function add(text, me=false){
      const t = new Date();
      const time = t.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
      const messages = JSON.parse(localStorage.getItem(KEY)||'[]');
      messages.push({text, me, time});
      localStorage.setItem(KEY, JSON.stringify(messages.slice(-200)));
      render();
    }
    if (!localStorage.getItem(KEY)){
      add('Welcome to GE & LE Studios. I’m your Forged Support secretary. Ask about chapters, rights, or press. 🔥');
      add('For direct replies, email: gumworld1976@yahoo.com.au');
    }
    function send(){
      const text = (inputEl.value||'').trim();
      if (!text) return;
      add(text, true);
      inputEl.value='';
      setTimeout(()=> add('Thanks! We’ll reply by email if needed. 🔥'), 400);
    }
    sendBtn.addEventListener('click', send);
    inputEl.addEventListener('keydown', e=>{ if (e.key==='Enter'){ e.preventDefault(); send(); }});
    fab.addEventListener('click', ()=> panel.classList.toggle('open'));
    render();
  })();
  </script>
</body>
                  </html>
